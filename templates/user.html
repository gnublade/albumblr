{% extends "base.html" %}

{% block title %}{{ username }}{% endblock %}

{% block headextra %}
<link type="text/css" href="http://jqueryui.com/latest/themes/base/ui.all.css" rel="stylesheet" />
{% endblock %}

{% block content %}
<div id="user-badge">
<div id="badge-avatar"><img src="{{ avatar }}" /></div>
<div id="badge-head"><h2>{{ username }}'s Albums</h2></div>
<div id="badge-info">
    <strong class="fn">{{ realname }}</strong>,
    {{ age }}, {{ gender }}, {{ country }}
</div>
</div>

<div id="tabs" class="clearit">
<ul>
    <li><a href="#liked-albums">Would Like</a></li>
    <li class="selected"><a href="#owned-albums">Owned</a></li>
    <li><a href="#recommended-artist-albums">By Recommended Artists</a></li>
</ul>

<div id="liked-albums">
<p>
Based on the albums {{ username }}'s got we think you would like the following
albums:
</p>
</div>

<div id="owned-albums">
<p>
Below is a list of albums that I think you own, whether on CD or some other
format.  If this is your first visit to Albumblr it might take me a little
while to figure this out so please be patient, refreshing just makes Google
angry!
</p>
<ul id='album-list'>
    {% for album in albums %}
    <li>{{ album }}</li>
    {% endfor %}
</ul>
</div>

<div id="recommended-artist-albums">
<p>
These are some artists recommended to {{ username }}, probably best taken with
a pinch of salt.
</p>
</div>
{% endblock %}

{% block bodyscript %}
<script src="http://www.google.com/jsapi"></script>
<script type="text/javascript" src="http://jqueryui.com/latest/ui/ui.tabs.js"></script>
<script>
google.load("jquery", "1.3.2");
google.load("jqueryui", "1.7.2");
function populateAlbumList(albums) {
    for (var i = 0; i < albums.length; i++) {
        $("#album-list").append("<li>" + albums[i] + "</li>");
    }
}
function getProcessed() {
    $.post("albums/processed", null, function (data) {
        if (data.albums) {
            populateAlbumList(data.albums);
        }
        if (data.remaining) {
            setTimeout('getProcessed()', 1000);
        }
    }, 'json');
}
google.setOnLoadCallback(function() {
    $("#tabs").tabs();
    $.post("albums/start", null, getProcessed);
});
</script>
{% endblock %}
